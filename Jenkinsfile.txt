pipeline {

    agent any
    tools {nodejs "16"}

    environment {
        PATH='C://Program Files//nodejs;c:\\Windows\\System32' 
	}

 stages {

      stage('NPM Install') {
         steps {
            echo 'execute cmd ...'
            bat "npm install"
         }
      }

 // stage('NPM Audit') {
   //      steps {
     //       echo 'execute cmd ...'
       //     bat "npm audit fix --force"
        // }
      //}

       stage('IOS Build') {
          steps {
            // sh 'ionic cordova build ios --release'
             echo "iOS"
             bat "npx ionic build --prod"
          }
       }

stage('IOS Build1') {
          steps {
            // sh 'ionic cordova build ios --release'
             echo "iOS"
             //bat "npx ionic capacitor open android"
		bat "npx ionic cap build android --no-open && cd android && gradle assembleDebug && gradle assembleRelease"
          }
       }


       stage('Android Build') {
          steps {
              // sh 'ionic cordova build android --release'
               echo "Android"
          }
       }

       stage('APK Sign') {
          steps {
            // sh 'jarsigner -storepass your_password -keystore keys/yourkey.keystore platforms/android/app/build/outputs/apk/release/app-release-unsigned.apk nameApp'
              echo "Android"
          }
       }

       stage('Android Release') {
          steps {
              // sh 'mv platforms/android/app/build/outputs/apk/release/app-release-unsigned.apk release/wall.apk'
               echo "Android"
          }
       }


      stage('Stage Web Build') {
          steps {
              sh 'npm run build --prod'
          }
       }

         stage('Publish Firebase Web') {
          steps {
              sh 'firebase deploy --token "YourTokenKey"'
          }
       }

        stage('Publish iOS') {
          steps {   
              echo "Publish iOS"
          }
       }

        stage('Publish Android') {
          steps {
              echo "Publish Android"
          }
       }


}
}


